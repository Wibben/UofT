#include <random>
#include <iostream>
#include <unittest++/UnitTest++.h>

#include "StreetsDatabaseAPI.h"
#include "m1.h"
#include "m3.h"
#include "m4.h"

#include "unit_test_util.h"
#include "courier_verify.h"

using ece297test::relative_error;
using ece297test::courier_path_is_legal_with_capacity;


SUITE(path_cost_new_york_usa_public) {
    TEST(path_cost_new_york_usa) {
        std::vector<unsigned> path;
        double right_turn_penalty;
        double left_turn_penalty;
        double expected;
        double actual;

        path = {42732, 213897, 213898, 213899, 213900, 213901, 213902, 213903, 213904, 213905, 213906, 213907, 36248, 38957};
        right_turn_penalty = 34.80376737924823516;
        left_turn_penalty = 0.12455752487476948;
        expected = 116.20210124326082735;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {183852, 183860, 27581, 27580, 27610, 27609, 27608, 27607, 27606, 27605, 185269, 185270, 185271, 185272, 185273, 185274, 185275, 185276, 185277};
        right_turn_penalty = 33.98311166934019667;
        left_turn_penalty = 37.34786263829035846;
        expected = 204.14916141031787333;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {1, 176491, 176492, 160260, 160261, 2670, 160123, 137381, 179727, 179728, 179729, 179730, 179731, 179732, 179733, 179691, 179690, 179721, 179693, 179694, 179695, 179696, 179697, 179698, 179699, 179700, 179701, 179702, 179703, 179704, 179705, 179706, 179707, 179708, 179709, 179710, 179711, 179712, 179713, 179714, 179715, 179716, 179717, 179718, 563, 562, 981, 16266, 193364};
        right_turn_penalty = 0.00000000000000000;
        left_turn_penalty = 0.00000000000000000;
        expected = 228.33366329154722507;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {155969, 155970, 155971, 155972, 155973, 155974, 155975, 155976, 155977, 155978, 155979, 155980, 155981, 155982, 155983, 155984, 155985, 155986, 155987, 155988, 155989, 193013, 193014, 193015, 193016, 193017, 193018, 193019, 193020, 193021, 193022, 193023, 193024, 193025, 193026, 193027, 193028, 193029, 193030, 193031, 193032, 193033, 193034, 193035, 193036, 193037, 193038, 193039, 193040, 193041, 193042, 193043, 193044, 193045, 45329, 45330, 45331};
        right_turn_penalty = 5.61048696871126040;
        left_turn_penalty = 32.47691475729003940;
        expected = 295.28951079162447968;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {131403, 131404, 131405, 131406, 131407, 131408, 131409, 131410, 131411, 153511, 153512, 153513, 153298, 153299, 153154, 153155, 153156, 153558, 153559, 153560, 153561, 153091, 84179, 84180, 84181, 84182, 84183, 84184, 84185, 84186, 84187, 153400, 153401, 153402, 153403, 153396, 153397, 153398, 153399, 153083, 153082, 163401, 163402, 163403, 84188, 84189, 84190, 84191, 84192, 84193, 153363, 153364, 153365, 153366, 153367, 153368, 153369, 153370, 86029, 86030};
        right_turn_penalty = 7.03669639623241228;
        left_turn_penalty = 12.58686460021206877;
        expected = 340.96695800556653921;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {221362, 221361, 221360, 213887, 213888, 213889, 213890, 213891, 213892, 213893, 213894, 213895, 213896, 213897, 213898, 213899, 213900, 213901, 213902, 213903, 213904, 213905, 213906, 213907, 213908, 213909, 213910, 213911, 190253, 190254, 190255, 190256, 190257, 190258, 190259, 190260, 190261, 190262, 190263, 131834, 131844, 133620, 133621, 133622, 133623, 133624, 133625, 133626, 133627, 133628, 133629, 133630, 133631, 133632, 133633, 133634, 133635, 133636, 133637, 133638, 133639, 133640, 133641, 133642};
        right_turn_penalty = 24.09472424377473843;
        left_turn_penalty = 42.81008306287900922;
        expected = 379.89820028083960324;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {42282, 190241, 190240, 190239, 190238, 190237, 190236, 190235, 190234, 190233, 190232, 190231, 190230, 190229, 190228, 190227, 190226, 190225, 190224, 190223, 190222, 190221, 190220, 190219, 190218, 190217, 190216, 190215, 190214, 190213, 40199, 40198, 40197, 40196, 40195, 40194, 40193, 40192, 40191, 40190, 40189, 40188, 40187, 40186, 40185, 40184, 40183, 40182, 40181, 40180, 40179, 40178, 40177, 40176, 40175, 40174, 191066, 191065, 191085, 191084, 191083, 191082, 191081, 191080, 191079, 198569, 198623, 198581, 198580, 203988, 198532, 198533, 198579, 198578, 198577, 198600, 198601, 198602, 198603, 198614, 198613, 198586};
        right_turn_penalty = 4.82294696422128943;
        left_turn_penalty = 3.13663460069664524;
        expected = 384.33132582865016502;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {186136, 186137, 186138, 186139, 186140, 186141, 186142, 186143, 186144, 186145, 186146, 186147, 186148, 186149, 169216, 169217, 220600, 220601, 220602, 143812, 143811, 143810, 143809, 143808, 143807, 143806, 143805, 143804, 143803, 143802, 143801, 143800, 143799, 143798, 203756, 203755, 203754, 203753, 203752, 3205, 3204, 3203, 3202, 3201, 3200, 3199, 3198, 219746, 188411};
        right_turn_penalty = 24.95119530609772340;
        left_turn_penalty = 20.71869492790949252;
        expected = 385.25072456790934439;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {187132, 187131, 187130, 187129, 187128, 187127, 187126, 187125, 186978, 186977, 144898, 144899, 144900, 186879, 173916, 173917, 173918, 173919, 181953, 181898, 181899, 181900, 181901, 181902, 181903, 181904, 181905, 181906, 181907, 181908, 181909, 181910, 181911, 181912, 181913, 189784, 189785, 189786, 189787, 187677, 187678, 163154, 163155, 163156, 163157, 163158, 189955, 188209, 188210, 188211, 188212, 189966, 189967, 187599, 187598, 187597, 187596, 204445, 204446};
        right_turn_penalty = 6.40562907376448543;
        left_turn_penalty = 5.66438894134502746;
        expected = 393.30779842427688209;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {189753, 144820, 144821, 144822, 144823, 144824, 144825, 144826, 144827, 144828, 182981, 182982, 182983, 182984, 182985, 182986, 182987, 182988, 182989, 182990, 182991, 182992, 182993, 182994, 182995, 182996, 182997, 182998, 138499, 138500, 138501, 138502, 138503, 215348, 215349, 167788, 167789, 167790, 167791, 167792, 167793, 167794, 216967, 216968, 216969, 216970, 216971, 216972, 215902, 215903, 215904, 215895, 215896, 215897, 215898, 215899, 215900, 215901, 214601, 214602, 214603, 214604, 216355, 216356, 216357, 216350, 216351, 216352, 211634, 211635, 211636, 211627, 211628, 211629, 211630, 211631, 211632, 211633, 215704, 215705, 215706, 215707, 215708, 215709, 215710, 215711, 215712, 215713, 215714, 215715};
        right_turn_penalty = 7.77774314237052344;
        left_turn_penalty = 35.11819608960134786;
        expected = 448.87276843064108789;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {205093, 205090, 205091, 205092, 199140, 199141, 207420, 207421, 207422, 207423, 147993, 147992, 148020, 198719, 198721, 61988, 134889, 207438, 128012, 134864, 134863, 134861, 134860, 167552, 167553, 167554, 99364, 99365, 153502, 153503, 153504, 153505, 153506, 153507, 153508, 153509, 145902, 145903, 145904, 145905, 145906, 145907, 145908, 145909, 145910, 145911, 145912, 145913, 145914, 145915, 145916, 145864, 145865, 145866, 145867, 145868, 145869, 209232, 209255, 209248};
        right_turn_penalty = 10.91687062824797216;
        left_turn_penalty = 29.44258670422591706;
        expected = 456.01101858419838209;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {80442, 80441, 80440, 167611, 167610, 154583, 153027, 153026, 153025, 163416, 153029, 153035, 153020, 153018, 153019, 153016, 153015, 153013, 152973, 152974, 152975, 152976, 152977, 152978, 163397, 148034, 148035, 148036, 148037, 148038, 163390, 153076, 153071, 153072, 153073, 153074, 153075, 153515, 153516, 153517, 153464, 153465, 153466, 153467, 153468, 153469, 153470, 153471, 153472, 153473, 130687, 153086, 153087, 153088, 153089, 153090, 153461, 153462, 153463, 153159, 153157, 153158, 153557, 153339, 153340, 153393, 131411, 131410, 131409, 131408, 131407, 104371};
        right_turn_penalty = 12.85377628263814564;
        left_turn_penalty = 33.63561318577550452;
        expected = 466.03051150981406181;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {203354, 203353, 165583, 172118, 172139, 172128, 133850, 133851, 128507, 128508, 128522, 172127, 172119, 128523, 150884, 150885, 168896, 168890, 168892, 168904, 128039, 157584, 157594, 157595, 157586, 157585, 157554, 157490, 157491, 145689, 145690, 145691, 145692, 145693, 145694, 145695, 145696, 145697, 145698, 145699, 145700};
        right_turn_penalty = 24.25335241384133766;
        left_turn_penalty = 10.23107885105380355;
        expected = 473.15747855248559972;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {30836, 30835, 159440, 159439, 159438, 159437, 159436, 159435, 159434, 159433, 159432, 159431, 159430, 159429, 159428, 159427, 159426, 159425, 159424, 159423, 159422, 159421, 159420, 159419, 159418, 159417, 159416, 159415, 159414, 159413, 159412, 159411, 159410, 159409, 159408, 159407, 159406, 159405, 159404, 159403, 159402, 159401, 159400, 159399, 159398, 159397, 159384, 159383, 159382, 181707, 181706, 181705, 181704, 181703, 181702, 181701, 181700, 181699, 181698, 181697, 181696, 181695, 181694, 181693, 181692, 196708, 196707, 196706, 196705, 196704, 196703, 196702, 196701, 196700, 196699, 196698, 196697, 196696, 196695, 181996, 181995, 181994, 181993, 181992, 181991, 181990, 181989, 181988, 181987, 181986, 181985, 181984, 181983, 181982, 181981, 181980, 166069, 166068, 182049, 182048, 182047, 27463, 27462, 27461, 21916};
        right_turn_penalty = 36.06300179656847149;
        left_turn_penalty = 25.39686256691487642;
        expected = 537.99683553967361149;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {201935, 201936, 201937, 7804, 7803, 169107, 7094, 189432, 189431, 189430, 189429, 6501, 6500, 6499, 143282, 143283, 143284, 143285, 143286, 143287, 143288, 143289, 143290, 143291, 131811, 131812, 131813, 197512, 197513, 197514, 197515, 197516, 197517, 197506, 188881, 188882, 188883, 197507, 197508, 197509, 197510, 197511, 189068, 189069, 189070, 189071, 166663, 166664, 166665, 4273, 189083, 189084, 186791, 186790, 186789, 186788, 186787, 186786, 186785, 186784, 186783, 186782, 186809, 210199, 8084, 8083, 8082, 8081, 8080, 8079, 8078};
        right_turn_penalty = 1.05446487223657415;
        left_turn_penalty = 41.13577114294545112;
        expected = 543.26673238850901271;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {188318, 188904, 188905, 188906, 188907, 188908, 188909, 188910, 188911, 188912, 188913, 188914, 188915, 188916, 188917, 188918, 188919, 188920, 188921, 188922, 188923, 188924, 188925, 188926, 188927, 188928, 188929, 188930, 188931, 188932, 188933, 188934, 142946, 142919, 142872, 2950, 2951, 2952, 2953, 182973, 182974, 182975, 182976, 182977, 182978, 182979, 182980, 182981, 182982, 182983, 182984, 182985, 182986, 182987, 182988, 182989, 182990, 182991, 182992, 182993, 182994, 182995, 182996, 182997, 182998, 138499, 138500, 138501, 138502, 138503, 215348, 215349, 167788, 167789, 167790, 167791, 167792, 167793, 167794, 216967, 216968, 216969, 216970, 216971, 216972, 215902, 215903, 215904, 215895, 215896, 215897, 215898, 215899, 215900, 215901, 214601, 214602, 214603, 214604, 216355, 216356, 30955, 29686, 216372};
        right_turn_penalty = 6.35816705519004177;
        left_turn_penalty = 30.12048399789413367;
        expected = 560.44658658895639292;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {100075, 161181, 161182, 161178, 161177, 161166, 164938, 161179, 161180, 153172, 153166, 153167, 153168, 153300, 153336, 153337, 153338, 153499, 153500, 153501, 153182, 153173, 153174, 153175, 153176, 153177, 153178, 153179, 153180, 153181, 153511, 153512, 153513, 153298, 153299, 153154, 153155, 153156, 153558, 153559, 153560, 153561, 153091, 84179, 84180, 84181, 84182, 84183, 84184, 84185, 84186, 84187, 153400, 153401, 153402, 153403, 153396, 153397, 153398, 153399, 153083, 153082, 163401, 163402, 163403, 84188, 84189, 84190, 84191, 84192, 84193, 153328, 153329, 153330, 153331, 152984, 146059, 85026, 85027, 85028, 85029};
        right_turn_penalty = 23.82592305742098659;
        left_turn_penalty = 35.94079801021751308;
        expected = 583.48881395629598501;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {23022, 23023, 23024, 23025, 23026, 23027, 23028, 194956, 194955, 194954, 194953, 194952, 194951, 194950, 194949, 194948, 194947, 194946, 194945, 194944, 194943, 194942, 194941, 194940, 194939, 194938, 181624, 181623, 181622, 181621, 181620, 181619, 181618, 181617, 181616, 181615, 181614, 181613, 181612, 181611, 181610, 181609, 181608, 181607, 181606, 181605, 181604, 181658, 181657, 184262, 184261, 184260, 184259, 184258, 184257, 184256, 184255, 184254, 184253, 184252, 184251, 184250, 184249, 184248, 184247, 184246, 184245, 184244, 184243, 184242, 184241, 184240, 184239, 184238, 183458, 183457, 181776, 181775, 181774, 144787, 184923, 184922, 184921, 184920, 184919, 184918, 184917, 184916, 184915, 184914, 178450, 178449, 178448, 178447, 178446, 178445, 178444, 183445, 183444, 178443, 178442, 178441, 178440, 178439, 178438, 178437, 178436, 178435, 166089, 166088, 166087, 166086, 166070, 182944, 184269, 184268, 184267, 184266, 181028, 181027, 181026, 181025, 181024, 181023, 181022, 181021, 181020, 181019, 181018, 181017, 181016, 181015, 181014, 181013, 181012, 27595, 23957};
        right_turn_penalty = 37.62136841057632353;
        left_turn_penalty = 30.02444647072044148;
        expected = 642.93392083212563648;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {24384, 24385, 24386, 24246, 19406, 19407, 223023, 223027, 184107, 184108, 215716, 215717, 215718, 215719, 222349, 222350, 222351, 222352, 222353, 222354, 222355, 211637, 211638, 216347, 216348, 216349, 216353, 216354, 222373, 222374, 222375, 222376, 222377, 222365, 222366, 222367, 222368, 222369, 222370, 222371, 222372, 215905, 215906, 215907, 215344, 215345, 215346, 215347, 215337, 215338, 215339, 215340, 215341, 215342, 215343, 215350, 215351, 222313, 222314, 222315, 222316, 222317, 222318, 222319, 142873, 142874, 142875, 142876, 142877, 142878, 142879, 142880, 142881, 142882, 142883, 142884, 142885, 142886, 142887, 142888, 142889, 142890, 142891, 142892, 142893, 142894, 142895, 142896, 142897, 187684, 138775, 138776, 138777, 138778, 138779, 138780, 138781, 138782, 138783, 138784, 189781, 189782, 189783, 181914, 181915, 181916, 181917, 181918, 181919, 181920, 181921, 173791, 173874, 173875, 173876, 173877, 173878, 173879, 173880, 173881, 173882, 197493, 174061, 174062, 186324, 186323, 186322, 186321, 186320, 186319, 186318, 9410};
        right_turn_penalty = 2.43588099882199627;
        left_turn_penalty = 22.19496657457319344;
        expected = 692.86056967782951688;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {150903, 150902, 150901, 138091, 69074, 69073, 195253, 195254, 195255, 195256, 195257, 195258, 195259, 195260, 195261, 195262, 195263, 195264, 195265, 195266, 195267, 195268, 195269, 195270, 195271, 195272, 195273, 195274, 195275, 195276, 195277, 195278, 65385, 65386, 65387, 65388, 65389, 65390, 65391, 65392, 65393, 65394, 65395, 65396, 65397, 65398, 147036, 147035, 147034, 147033, 147032, 147031, 147030, 147029, 147028, 147027, 147026, 147025, 161663, 161645, 148319, 148320, 148321, 163364, 163365, 139219, 158087, 139213, 139214, 139215, 139216, 139217, 139218, 139197, 139198, 139199, 139200, 139191, 139192, 139193, 139194, 139195, 139196, 198663, 198657, 198658, 198659, 139153, 139154, 139177, 139178, 139179, 139180, 138920, 224205, 224204, 224207, 147462};
        right_turn_penalty = 16.36213486633057457;
        left_turn_penalty = 43.33765910392968124;
        expected = 716.39899700122327886;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {208995, 129172, 129173, 150168, 150169, 164179, 164180, 207314, 207315, 223813, 128010, 61432, 61433, 134870, 134868, 130244, 130245, 207305, 207306, 150170, 164181, 164186, 164187, 164188, 150203, 147383, 130688, 130689, 153293, 153294, 153295, 153296, 153361, 153362, 153394, 153434, 153474, 153475, 153518, 153519, 153520, 153521, 153554, 153236, 153242, 153243, 153523, 153342, 153389, 153390, 153391, 153392, 153316, 153317, 153318, 153319, 153320, 153332, 153333, 153334, 153335, 153336, 153337, 153338, 153499, 153500, 153501, 153182, 153173, 153174, 153175, 153176, 153177, 153178, 153179, 153180, 153181, 153511, 153512, 153513, 153458, 153459, 131400, 131401, 153135, 153136};
        right_turn_penalty = 22.24870375772763964;
        left_turn_penalty = 16.28432964428702689;
        expected = 749.01780903109727205;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {211253, 211257, 211254, 211258, 211259, 132109, 132135, 132157, 132156, 132155, 132154, 132153, 132152, 132151, 132150, 132149, 132148, 132147, 132146, 132145, 132144, 132143, 132142, 132141, 132136, 132137, 132138, 132139, 132140, 181502, 181503, 181504, 181505, 183778, 183777, 183776, 183775, 183774, 183773, 183772, 183771, 183770, 184558, 184557, 184556, 184555, 184554, 184553, 184552, 181643, 181642, 181641, 181640, 181639, 181638, 181637, 181636, 181635, 181634, 181633, 181632, 181631, 181630, 181629, 181628, 181627, 181626, 181625, 181536, 184936, 184935, 184934, 184933, 184932, 184931, 184930, 184929, 184928, 184927, 184926, 184925, 184924, 183472, 183471, 183470, 183469, 183468, 183467, 183466, 183465, 183464, 183447, 182708, 182707, 182706, 182705, 181511, 184408, 184407, 184406, 184402, 184401, 184400, 184399, 184398, 184573, 184572, 184045, 184174, 184173, 139844, 139843, 139842, 139841, 139840, 138828, 166072, 166071, 166090, 35359, 35358, 35357, 35356, 35355, 35354, 35353, 35352, 35351, 35350, 35349, 35348, 35347, 35346, 35345, 35344, 35343, 35342, 35341, 35340, 183814, 183813, 183812, 183811, 183810, 183809, 183819, 183818, 183817, 183816, 183815, 166339, 166338, 166337, 166336, 166335, 166334, 166333, 166345, 178575, 178574, 178573, 178572, 178571, 178570, 178569, 178568, 178567, 178566, 178565, 178576, 196854, 196857, 196856, 196855, 187086, 187085, 187084, 187083, 187082, 31786, 31785, 171531, 171532, 134587, 134588, 134589};
        right_turn_penalty = 9.52446107175621215;
        left_turn_penalty = 37.86849546991184212;
        expected = 799.48348381493292436;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {69342, 63464, 175426, 175427, 94096, 94097, 94098, 94099, 94100, 94101, 94102, 94103, 94104, 94105, 94106, 156662, 156663, 156664, 156751, 156752, 156753, 156657, 156610, 156611, 156615, 156614, 156656, 139215, 139216, 139217, 139218, 139197, 139198, 139199, 139200, 139191, 139192, 139193, 139194, 139195, 139196, 198663, 198657, 198658, 198659, 139153, 139154, 139177, 139178, 139179, 139180, 138920, 156983, 156984, 156985, 210614, 210613, 210612, 210611, 210610, 203080, 203079, 203078, 203077, 203076, 203075, 203074, 203073, 203072, 203071, 203070, 203069, 203068, 95556, 156896, 156895, 156894, 156893, 156892, 156891, 156890, 156889, 156888, 156887, 156886, 156885, 156884, 156883, 156882, 156881, 156880, 156879, 156878, 156877, 156876, 156875, 156874, 156873, 156872, 156871, 156749, 156748};
        right_turn_penalty = 20.12262652719477884;
        left_turn_penalty = 28.35715000099462202;
        expected = 813.85603103224320876;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {19812, 19813, 19814, 187014, 187015, 187016, 187017, 187018, 186900, 186901, 186902, 186903, 186904, 186905, 186906, 186907, 186908, 186909, 186910, 186911, 186912, 186913, 186914, 186915, 186916, 186917, 186918, 186919, 186920, 186921, 186922, 186923, 186924, 186925, 209397, 209398, 209422, 209423, 163624, 163625, 163598, 163599, 163600, 163517, 142749, 142748, 163577, 178725, 178726, 178727, 178714, 178715, 178716, 178717, 178718, 178719, 178720, 178721, 178722, 178723, 178724, 209401, 209402, 209403, 209404, 209405, 209406, 209407, 209408, 209409, 178713, 163538, 138624, 138625, 163543, 163544, 163545, 163546, 163547, 23858, 207547, 207546, 178648, 190182, 190183, 178649, 178650, 178651, 178652, 178653, 212481, 212480, 181111, 181110, 190025, 190024, 190023, 190022, 190021, 190020, 190019, 190018, 190017, 190016, 190015, 190014, 190013, 190012, 190011, 190010, 190009, 190008, 190029, 180930, 180929, 201904, 201903, 201902, 201901, 201900, 201899, 177902, 177901, 177900, 177899, 177898, 177897, 177896, 177895, 177894, 177893, 195922, 195921, 195920, 195919, 177904, 177903, 177892, 177891, 126639, 126638, 126637, 126636, 126635, 126634, 29012, 29013, 29014, 29015};
        right_turn_penalty = 17.29314300038691599;
        left_turn_penalty = 43.88851354135337601;
        expected = 943.29500022745469323;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {167302, 167301, 167300, 167299, 167310, 167309, 167308, 102185, 102184, 102183, 102182, 102181, 102180, 145907, 145906, 145905, 145904, 145903, 145902, 153509, 153508, 153507, 153506, 153505, 153504, 153503, 153502, 99365, 150203, 147383, 130688, 130689, 153293, 153294, 153295, 153296, 153361, 153362, 153394, 153434, 153474, 153475, 153518, 153519, 153520, 153521, 153554, 153236, 153242, 153243, 153523, 153342, 153389, 153390, 153391, 153392, 153316, 153317, 153318, 153319, 153320, 153332, 153333, 153334, 153335, 153336, 153337, 153338, 153499, 153500, 153501, 153182, 153173, 153174, 153175, 153176, 153177, 153178, 153179, 153180, 153181, 153511, 153512, 153513, 153298, 153299, 153154, 153155, 153156, 153558, 153559, 153560, 153561, 153091, 84179, 84180, 84181, 84182, 84183, 84184, 84185, 84186, 84187, 153400, 153401, 153402, 153403, 153396, 153397, 153398, 153399, 153083, 153082, 163401, 163402, 163403, 84188, 84189, 84190, 84191, 84192, 84193, 153363, 153364, 153365, 153366, 153367, 153368, 153369, 153370, 153371, 153372, 153373, 153374, 153375, 153376, 153377, 153378, 153379, 153380, 179957, 179944, 179945, 179946, 81963, 81962};
        right_turn_penalty = 31.25934621136832092;
        left_turn_penalty = 10.71301989086309270;
        expected = 985.04498621063919472;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {18295, 18294, 18293, 18292, 18291, 211254, 211258, 211259, 132109, 132135, 132157, 132156, 132155, 132154, 132153, 132152, 132151, 132150, 132149, 132148, 132147, 132146, 132145, 132144, 132143, 132142, 132141, 132136, 132137, 132138, 132139, 132140, 181502, 181503, 181504, 181505, 183778, 183777, 183776, 183775, 183774, 183773, 183772, 183771, 183770, 184558, 184557, 184556, 184555, 184554, 184553, 184552, 181643, 181642, 181641, 181640, 181639, 181638, 181637, 181636, 181635, 181634, 181633, 181632, 181631, 181630, 181629, 181628, 181627, 181626, 181625, 181536, 184936, 184935, 184934, 184933, 184932, 184931, 184930, 184929, 184928, 184927, 184926, 184925, 184924, 183472, 183471, 183470, 183469, 183468, 183467, 183466, 183465, 183464, 183447, 182708, 182707, 182706, 182705, 181511, 184408, 184407, 184406, 184402, 184401, 184400, 184399, 184398, 184573, 184572, 184045, 184174, 184173, 139844, 139843, 139842, 139841, 139840, 127268, 127269, 127270, 127271, 127272, 182766, 173430, 173433, 173434, 166092, 127250, 127243, 127244, 127245, 127246, 142499, 167439, 167440, 184180, 184181, 184182, 184183, 184184, 184185, 184186, 184187, 184188, 184189, 184190, 184191, 184353, 184323, 184324, 184325, 184326, 184327, 184328, 184329, 184330, 184331, 184332, 184333, 184334, 184335, 184336, 184337, 184338, 184339, 184340, 184341, 184342, 184343, 184344, 184345, 178007, 178008, 171372, 178009, 178010, 178011, 178012, 178013, 178014, 178015, 178016, 178648, 190182, 190183, 178649, 178650, 178651, 178652, 178653, 178628, 178629, 178630, 178631, 178632, 178633, 178634, 178635, 178636, 178637, 178638, 178639, 178640, 178641, 178642, 178643, 178644, 173045, 173047, 173048, 173049, 173050, 173051, 173052, 173053, 173054, 173055, 173056, 173057, 173058, 173059, 173060, 28957, 28958, 165627, 34385};
        right_turn_penalty = 16.57142701351734004;
        left_turn_penalty = 44.72871134235121815;
        expected = 1044.83167046963103530;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {63761, 68434, 68435, 68436, 68437, 68438, 68439, 68440, 68441, 68442, 68443, 68444, 68445, 68446, 68447, 68448, 68449, 68450, 68451, 68452, 68453, 68454, 68455, 68456, 68457, 68458, 68459, 138868, 138865, 128924, 157019, 157020, 157021, 157022, 157023, 157024, 138897, 93512, 138898, 138899, 138900, 158059, 158060, 158061, 138889, 138885, 158030, 158031, 158032, 158033, 158034, 158035, 158036, 158037, 158038, 139172, 139173, 139174, 139170, 139171, 198668, 198665, 198666, 198667, 139187, 139188, 139189, 139190, 139202, 139203, 139204, 139205, 139206, 139207, 139208, 139209, 139222, 139211, 139220, 139221, 163359, 163360, 163361, 163362, 163363, 148325, 148323, 148324, 148119, 148120, 148121, 148122, 146911, 146900, 146901, 218128, 218127, 146924, 146925, 146926, 146930, 146914, 146915, 146916, 146932, 146934, 146935, 131322, 131323, 131318, 131319, 131320, 131321, 138023, 138024, 128373, 128374, 128375, 128376, 127623, 148086, 148087, 163374, 163375, 163376, 127855, 127964, 127965, 163314, 163315, 163352, 149367, 149368, 149369, 128162, 128163, 149358, 149357, 161384, 128158, 128311, 128312, 161428, 127918, 195548, 128081};
        right_turn_penalty = 0.14222015799686585;
        left_turn_penalty = 7.54622075948975723;
        expected = 1350.15777483266720083;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {125589, 119772, 119771, 125006, 175147, 175146, 175145, 175144, 175143, 175142, 175141, 175140, 175139, 175138, 175137, 175136, 175135, 175134, 175133, 175132, 175131, 175130, 175129, 175128, 121349, 121348, 121347, 121346, 121345, 121344, 121343, 167829, 167828, 167827, 167826, 167825, 167824, 167823, 167822, 167821, 167820, 167819, 167818, 167817, 167816, 167815, 167814, 167813, 167812, 167811, 167810, 167809, 167808, 167807, 167806, 167805, 167804, 167803, 167802, 167801, 182351, 182340, 182339, 182338, 182337, 139895, 139894, 139893, 139892, 139891, 139890, 139889, 139888, 139887, 139886, 139885, 139884, 139883, 139882, 139881, 139880, 139879, 131635, 131634, 126916, 126917, 209744, 139874, 139875, 139876, 139877, 139878, 182381, 182380, 182379, 182378, 182377, 182376, 182375, 182374, 182373, 182372, 182371, 149263, 149262, 149261, 149260, 149259, 149258, 149257, 149256, 149255, 149254, 149253, 166190, 166189, 166188, 149265, 149264, 210294, 210293, 210292, 210291, 210290, 210289, 210288, 210287, 183399, 183400, 183401, 183402, 138757, 138756, 138755, 138754, 138753, 138752, 138751, 138750, 138749, 135674, 183225, 183226, 135673, 166455, 166453, 24997, 24998, 24999, 25000, 25001, 25002, 25003, 18853, 18854, 24993, 24994, 24995, 24996, 138740, 181643, 181642, 181641, 181640, 181639, 181638, 181637, 181636, 181635, 181634, 181633, 181632, 181631, 181630, 181629, 181628, 181627, 181626, 181625, 181536, 184936, 184935, 184934, 184933, 184932, 184931, 184930, 184929, 184928, 184927, 184926, 184925, 184924, 183472, 183471, 183470, 183469, 183468, 183467, 183466, 183465, 183464, 183447, 182708, 182707, 182706, 182705, 181511, 184408, 184407, 184406, 184402, 184401, 184400, 184399, 184398, 184573, 184572, 184045, 184174, 184173, 139844, 139843, 139842, 139841, 139840, 138828, 166072, 166071, 166090, 35359, 173272, 173273, 182945, 182946, 138683, 138684, 182941, 182942, 138671, 138672, 138673, 138674, 138675, 144783, 182003, 184131, 184130, 184129, 184128, 184127, 184126, 184125, 184124, 184122, 184121, 185279, 185278, 185277, 185276, 34713, 215099};
        right_turn_penalty = 18.94367963757247253;
        left_turn_penalty = 15.59123599507939772;
        expected = 1390.57302604323717787;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {103667, 101167, 101168, 101169, 210540, 70302, 70303, 157409, 157410, 157411, 157412, 125851, 128540, 168901, 168902, 165595, 128609, 157601, 157603, 157602, 157596, 157604, 157605, 157597, 165591, 141379, 141380, 165584, 165586, 165593, 161379, 161380, 171155, 134960, 151034, 64385, 105837, 128612, 128613, 128614, 128625, 160986, 128636, 128637, 160923, 205485, 127810, 128632, 128633, 128642, 160929, 160930, 160931, 128065, 128066, 128072, 128073, 128074, 127767, 205497, 127768, 127769, 127770, 147570, 147571, 147572, 164487, 150218, 164485, 164486, 105993, 154585, 58, 207548, 207549, 65, 138204, 160270, 1642, 1643, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 105895, 105894, 105893, 139304, 202080, 138932, 138931, 170941, 170940, 170939, 170938, 170937, 170936, 268, 269, 270, 271, 188001, 188002, 188003, 188004, 198653, 198654, 198655, 135469, 139766, 135459, 139765, 8859, 8860, 8861, 138771, 138772, 188010, 184288, 188101, 143188, 143187, 184295, 184296, 184297, 184298, 184299, 184300, 184301, 184302, 184303, 184304, 184305, 184306, 184307, 184308, 184309, 184310, 184311, 184312, 184313, 184314, 184315, 184316, 184317, 184318, 184319, 197391, 197392, 197393, 223586, 188793, 188725, 187248, 187249, 187250, 187251, 187252, 187300, 187301, 187302, 187303, 187304, 187305, 187306, 187307, 187308, 187309, 187310, 187311, 187312, 197540, 188072, 188073, 188074, 188075, 188076, 188077, 182999, 183000, 188588, 188628, 188629, 188630, 188631, 188632, 188633, 188959, 188960, 188961, 188962, 188963, 188964, 188965, 188966, 188967, 188968, 188969, 188970, 188971, 188972, 188973, 188974, 188975, 188976, 186017, 186018, 188373, 188374, 186013, 186014, 186015, 186016, 187685, 188208, 188181, 188182, 188183, 188184, 188185, 188186, 188187, 188188, 188189, 188190, 188191, 188192, 188193, 188194, 188195, 188196, 188197, 8101, 139010, 139011, 6047, 6048, 6046, 142949, 142971, 3011, 3012, 3013, 3014, 187683, 187684, 182973, 182974, 182975, 182976, 182977, 182978, 182979, 182980, 182981, 182982, 182983, 182984, 182985, 182986, 182987, 182988, 182989, 182990, 182991, 182992, 182993, 182994, 182995, 182996, 182997, 10027, 181424, 181413, 181417, 186960, 186961, 181408, 181414, 181415, 181416, 181410, 181418, 181419, 181420, 181421, 181422, 181423, 181411, 181412, 181409, 145028, 145029, 145030, 134270, 189114, 189115, 189116, 189117, 182205, 144960, 144957, 144958, 144959, 144942, 134260, 187388, 173779, 134343, 170197, 170188, 170187, 170127, 169893, 169964, 169866, 169867, 169868, 169869, 169870, 169871, 169872, 169873};
        right_turn_penalty = 0.00000000000000000;
        left_turn_penalty = 0.00000000000000000;
        expected = 1747.51580630478838430;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

        path = {206386, 206387, 207274, 207273, 207272, 207271, 207270, 207269, 207268, 207267, 207266, 207265, 207264, 207263, 207262, 207261, 207260, 207259, 207258, 191794, 191793, 67717, 67716, 67715, 67714, 67713, 67712, 67711, 67710, 154014, 154020, 154019, 154018, 62513, 195505, 195506, 73079, 73080, 73081, 73082, 73083, 73084, 73085, 167023, 167022, 167021, 167024, 167025, 64653, 64654, 131229, 131230, 131231, 75874, 146960, 146961, 146962, 146963, 146964, 195454, 195455, 195456, 195457, 195449, 195450, 195451, 195452, 195453, 206968, 206969, 206970, 206971, 206972, 206973, 206974, 206975, 206976, 206977, 206978, 206979, 206980, 206981, 206982, 78809, 127609, 127610, 150259, 150260, 221875, 221876, 129756, 129755, 129754, 129753, 129752, 129757, 129758, 129759, 147591, 147592, 147593, 129760, 147606, 147583, 147584, 147585, 147586, 163312, 78808, 77819, 128244, 128245, 163291, 147578, 163292, 163293, 177768, 177806, 177807, 177810, 177741, 177742, 128870, 151720, 147381, 151732, 151731, 151824, 167562, 151825, 127844, 127865, 150249, 164855, 127763, 127764, 127765, 127766, 165654, 147570, 147571, 147572, 164487, 150218, 164485, 164486, 105993, 154585, 58, 207548, 207549, 65, 138204, 160270, 1642, 1643, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 105895, 105894, 105893, 139304, 202080, 138932, 138931, 170941, 170940, 170939, 170938, 170937, 170936, 268, 269, 270, 271, 188001, 188002, 188003, 188004, 198653, 198654, 198655, 135469, 135468, 139762, 139764, 135474, 135149, 139760, 165322, 135166, 143077, 164919, 164923, 143205, 143126, 143125, 143133, 143130, 135520, 164915, 142194, 142201, 164902, 142198, 142203, 126531, 161857, 161858, 161865, 161866, 161867, 172935, 172930, 172931, 164899, 135294, 142522, 201905, 142639, 161859, 178597, 178596, 178595, 178594, 178593, 178592, 178591, 178590, 178589, 178588, 178587, 178586, 178585, 178584, 178583, 178582, 178581, 177998, 177997, 177996, 177995, 177994, 177993, 177992, 177991, 177990, 177989, 177988, 177987, 177986, 177985, 177984, 177983, 177982, 177981, 177980, 177979, 177978, 177977, 177976, 177975, 177974, 177973, 177972, 177971, 177970, 177969, 177968, 139896, 126259, 126260, 19765, 166269, 166270, 126307, 166265, 126409, 126410, 166280, 166277, 166278, 190040, 126240, 126241, 126242, 126243, 126244, 126245, 126238, 126239, 126146, 177999, 183018, 183019, 182370, 126147, 126148, 126149, 126150, 126151, 126152, 126153, 126154, 126155, 126156, 126157, 126158, 126159, 126160, 126161, 126162, 126163, 126164, 126165, 25432, 25433, 25434, 25435, 25436, 25437, 25438, 25439, 25440, 25441, 25442, 25443, 202159, 202158};
        right_turn_penalty = 0.00000000000000000;
        left_turn_penalty = 0.00000000000000000;
        expected = 1760.39746300544425139;
        actual = compute_path_travel_time(path, right_turn_penalty, left_turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001000000);

    } //path_cost_new_york_usa

} //path_cost_new_york_usa_public

